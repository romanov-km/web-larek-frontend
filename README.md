# Проектная работа "Веб-ларек"

Реализация простого интернет магазина Веб-ларек с возможность оформления заказа.

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
и открыть в браузере страницу по адресу http://localhost:8080

```

или

```
yarn
yarn start
и открыть в браузере страницу по адресу http://localhost:8080

```
## Сборка

```
npm run build
```

или

```
yarn build
```

Для данного проекта нет ограничений по использованию пакетного менеджера, поэтому можно
использовать также YARN или PNPM.

## Архитектура

## Базовый код

1. Класс EventEmitter

Реализует паттерн «Наблюдатель» и позволяет подписываться на события и уведомлять подписчиков
о наступлении события.
Класс имеет методы on ,  off ,  emit  — для подписки на событие, отписки от события и уведомления
подписчиков о наступлении события соответственно.
Дополнительно реализованы методы  onAll и  offAll  — для подписки на все события и сброса всех
подписчиков.
Интересным дополнением является метод  trigger , генерирующий заданное событие с заданными
аргументами. Это позволяет передавать его в качестве обработчика события в другие классы. Эти
классы будут генерировать события, не будучи при этом напрямую зависимыми от
класса  EventEmitter.

2. Класс Component<T>

Абстрактный класс Component<T>, который предоставляет базовый функционал для работы с DOM-элементами в дочерних компонентах.
Этот класс предоставляет удобные методы для изменения внешнего вида и состояния DOM-элементов, это полезно при создании компонентов пользовательского интерфейса.
Конструктор: Принимает один аргумент container, представляющий собой корневой элемент, к которому будет привязан компонент.

Методы для работы с DOM:

toggleClass: Переключает класс у указанного элемента.
setText: Устанавливает текстовое содержимое элемента.
setDisabled: Устанавливает или убирает атрибут disabled для блокировки или разблокировки элемента.
setHidden: Скрывает элемент, устанавливая стиль display: none.
setVisible: Показывает элемент, удаляя стиль display: none.
setImage: Устанавливает изображение для элемента с опциональным альтернативным текстом.
Метод render:
Возвращает корневой DOM-элемент компонента.
Принимает объект data в качестве аргумента, который может содержать данные для инициализации компонента.

3. Класс API

Класс Api предоставляет удобные методы для выполнения GET и POST запросов с использованием Fetch API. 
Он также обрабатывает ответы от сервера, что упрощает обработку ошибок и успешных ответов в клиентском коде.

Конструктор: Принимает два аргумента: baseUrl (базовый URL для всех запросов) и options (настройки запроса, по умолчанию пустые).
Устанавливает базовый URL и формирует настройки запроса, включая заголовок 'Content-Type' со значением 'application/json'.

Методы:

handleResponse: Обрабатывает ответ от сервера.
Если ответ успешен (с кодом 2xx), возвращает JSON-представление ответа.
Если ответ содержит ошибку (код не 2xx), возвращает отклоненное обещание с ошибкой из JSON-представления ответа или текста статуса.

get: Выполняет GET-запрос к указанному URI (дополняя его базовым URL).
Использует fetch для выполнения запроса.
Применяет настройки запроса из конструктора.
Обрабатывает ответ с помощью handleResponse.

post: Выполняет POST-запрос к указанному URI (дополняя его базовым URL).
Использует fetch для выполнения запроса.
Применяет настройки запроса из конструктора, включая передачу данных в формате JSON.
Обрабатывает ответ с помощью handleResponse.

4. Класс Model<T>

Общий функционал этого класса позволяет создавать модели с возможностью уведомления других компонентов или сервисов о своих изменениях.
Конструктор:

Принимает два аргумента: data (частичные данные для инициализации модели) и events (интерфейс событий для уведомления об изменениях).
Использует Object.assign для копирования свойств из data в экземпляр модели.
Методы: 

emitChanges:
Уведомляет об изменениях, вызывая метод emit из объекта событий (events).
Принимает event - название события и опциональный payload - данные, которые могут сопровождать событие. Если payload не указан, передается пустой объект.

## Ключевые типы данных 

EventName: Тип для представления имени события, может быть строкой или регулярным выражением.
Subscriber: Тип для представления функции-подписчика события.
EmitterEvent: Тип данных, представляющий событие с именем и данными.
FormErrors: Тип для представления ошибок формы, ассоциированных с полями заказа.
ApiPostMethods: Тип для представления методов HTTP-запроса (POST, PUT, DELETE).
ApiListResponse: Тип данных для представления ответа от API, содержащего список элементов указанного типа.

## Интерфейсы 
IFormState: Интерфейс для представления состояния формы с флагом валидности и массивом ошибок.
IProductItem: Интерфейс для представления свойств продукта в каталоге.
ICard: Интерфейс для представления свойств карточки продукта, расширяющий интерфейс IProductItem.
ICardActions: Интерфейс для представления действий, связанных с карточкой продукта.
IOrderModal: Интерфейс для представления модальных данных заказа, таких как способ оплаты и адрес доставки.
IContactModal: Интерфейс для представления модальных данных контактов, таких как электронная почта и телефон.
IOrder: Интерфейс для представления заказа, расширяющий интерфейсы IOrderModal и IContactModal.
IAppState: Интерфейс для представления состояния приложения, содержащего каталог, корзину, превью, заказ и модальные данные.
IWebLarekAPI: Интерфейс для представления методов API, таких как получение списка продуктов, получение отдельного продукта и размещение заказа.
IOrderResult: Интерфейс для представления результата заказа, содержащего идентификатор и общую стоимость.
IPage: Интерфейс для представления страницы, содержащей счетчик и каталог элементов.
IEvents: Интерфейс для работы с событиями, предоставляющий методы для подписки и эмитации событий.
ISuccess: Интерфейс для представления успешного действия, содержащего общую стоимость.
ISuccessActions: Интерфейс для представления действий, связанных с успешным сценарием.
IBasketView: Интерфейс для представления представления корзины, содержащего элементы и общую стоимость.
IModalData: Интерфейс для представления данных модального окна, содержащего контент.

## Классы  

1. Basket 

Класс Basket представляет корзину в интернет-магазине и наследуется от базового класса Component.
Этот класс отвечает за отображение и управление состоянием корзины в интерфейсе приложения. При изменении элементов и общей стоимости, класс обновляет соответствующие элементы на странице.

Конструктор: Принимает container (корневой элемент корзины) и объект событий (events).
Инициализирует и сохраняет ссылки на элементы корзины, такие как список _list, общая стоимость _total и кнопка _button.
Устанавливает обработчик события на кнопку для открытия заказа при клике.

Методы:

items:
Устанавливает содержимое корзины.
Если корзина не пуста, заменяет дочерние элементы списка корзины на переданный массив элементов.
Если корзина пуста, заменяет дочерние элементы списка на абзац с сообщением "Корзина пуста".

total:
Устанавливает общую стоимость корзины, используя переданное значение.
Использует метод setText для установки текстового содержимого общей стоимости.

2. Form 

Этот класс предназначен для работы с формами в интерфейсе приложения, обрабатывая ввод пользователя, отслеживая изменения и уведомляя другие компоненты о событиях формы.

Конструктор: Принимает container (HTML-элемент формы) и объект событий (events).
Инициализирует и сохраняет ссылки на элементы формы, такие как кнопка отправки _submit и блок для отображения ошибок _errors.
Устанавливает обработчики событий на изменения в полях формы и отправку формы.
Метод:

onInputChange: Обработчик изменений в полях формы.
Использует события для уведомления других компонентов об изменении значения в конкретном поле.

set valid и set errors: Устанавливают состояние валидности формы и отображают ошибки, соответственно.

render: Обновляет состояние формы, включая валидность, ошибки и значения полей.
Вызывает метод super.render для обновления общего состояния компонента.

3. Modal 

Этот класс управляет отображением и состоянием модального окна в интерфейсе приложения, а также взаимодействует с другими компонентами через события.

Конструктор: Принимает container (HTML-элемент модального окна) и объект событий (events).
Инициализирует и сохраняет ссылки на элементы модального окна, такие как кнопка закрытия _closeButton и контент _content.
Устанавливает обработчики событий для закрытия модального окна при клике на кнопку закрытия, вне окна и на самом контенте.
Методы:  

set content: Устанавливает контент модального окна, заменяя текущий контент на переданный элемент.

open(): и close(): Открывают и закрывают модальное окно соответственно.
Отправляют соответствующие события при открытии и закрытии модального окна.

render:
Обновляет состояние модального окна, используя переданные данные.
Вызывает метод open для открытия модального окна.

4. Success

Этот класс отвечает за отображение сообщения об успешном заказе и предоставляет возможность выполнения дополнительных действий при успешном сценарии, таких как закрытие модального окна или перенаправление на другую страницу.

Конструктор:

Принимает container (HTML-элемент для отображения сообщения об успешном заказе) и объект actions с действиями при успешном заказе.
Инициализирует и сохраняет ссылки на элементы, такие как кнопка закрытия _close и общая информация о заказе _total.
Устанавливает обработчик события на кнопку закрытия в случае наличия соответствующего действия.
Метод:

set total: Устанавливает общую информацию о заказе, отображая переданное значение.
Обновляет содержимое элемента _total текстом, указывая количество синапсов.

1. AppData

Класс ProductItem представляет модель продукта в интернет-магазине. Он наследуется от абстрактного класса Model и содержит поля, соответствующие свойствам продукта (например, название, идентификатор, цена, описание и др.).

Класс AppState также наследуется от абстрактного класса Model и представляет глобальное состояние приложения. Он содержит информацию о корзине (basket), каталоге продуктов (catalog), заказе (order), превью продукта (preview), а также об ошибках формы (formErrors).

Методы класса AppState выполняют различные операции с данными, такие как добавление и удаление продукта из корзины, обновление состояния корзины, очистка корзины, установка каталога продуктов, установка превью продукта, а также валидация данных заказа и контактной информации.

В целом, классы ProductItem и AppState представляют важные компоненты модели данных и состояния интернет-магазина, обеспечивая удобный способ управления информацией о продуктах, заказах и других аспектах приложения.

2. Card 

Этот класс предназначен для отображения информации о продукте в интерфейсе приложения и обеспечивает взаимодействие с другими компонентами через заданные действия.

Конструктор: Принимает container (HTML-элемент карточки продукта) и объект actions с действиями для карточки.
Инициализирует и сохраняет ссылки на элементы карточки, такие как заголовок _title, изображение _image, описание _description, кнопка _button, цена _price, категория _category, индекс _index.
Устанавливает обработчик событий на кнопку (если есть) для выполнения соответствующего действия.

Сеттеры и гетеры:

set category и get category: Устанавливают и возвращают категорию продукта, также добавляя соответствующий класс стиля.

set index и get index: Устанавливают и возвращают индекс продукта в корзине.

set id и get id: Устанавливают и возвращают уникальный идентификатор продукта.

set image: Устанавливает изображение продукта, используя метод setImage.

set price: Устанавливают и возвращают цену продукта.


3. Order

Данный код содержит два класса: ContactModal и OrderModal, которые расширяют базовый класс Form.

ContactModal:

Этот класс представляет модальное окно для ввода контактных данных (телефона и электронной почты) при оформлении заказа.
Расширяет базовый класс Form, что подразумевает использование формы для ввода данных.
Предоставляет методы setPhone и setEmail для установки значений полей телефона и электронной почты соответственно.

OrderModal:

Этот класс представляет модальное окно для ввода данных о заказе, таких как адрес доставки и способ оплаты.
Расширяет базовый класс Form и дополняет его кнопками для выбора способа оплаты ("Онлайн" и "Наличные").
Имеет метод setAddress для установки значения поля адреса доставки.
Использует метод ensureElement для получения кнопки "Онлайн" и установки активного состояния.
Оба класса имеют общую базу в виде класса Form, что упрощает повторное использование логики работы с формами в приложении.

4. Page 

Этот класс управляет отображением основной страницы интернет-магазина, обновляет содержимое счетчика корзины, каталога продуктов и блокирует страницу при необходимости.

Конструктор: Принимает container (HTML-элемент страницы) и объект событий (events).
Инициализирует и сохраняет ссылки на элементы страницы, такие как счетчик корзины _counter, каталог продуктов _catalog, обертка страницы _wrapper, иконка корзины _basket.
Устанавливает обработчик события на клик по иконке корзины для открытия корзины.

set counter, set catalog и set locked
Устанавливают соответственно значения счетчика корзины, содержимого каталога и блокировки страницы.
