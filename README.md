# Проектная работа "Веб-ларек"

Реализация простого интернет магазина Веб-ларек с возможность оформления заказа.

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start

```
и открыть в браузере страницу по адресу http://localhost:8080

или

```
yarn
yarn start
```

и открыть в браузере страницу по адресу http://localhost:8080

## Сборка

```
npm run build
```

или

```
yarn build
```

Для данного проекта нет ограничений по использованию пакетного менеджера, поэтому можно
использовать также YARN или PNPM.


## Базовый код

### Класс EventEmitter

Реализует паттерн «Наблюдатель» и позволяет подписываться на события и уведомлять подписчиков о наступлении события.

```constructor()``` инициализация

Методы

* ```on```, ```off```, ```emit```  — для подписки на событие, отписки от события и уведомления
подписчиков о наступлении события соответственно  
Дополнительно реализованы методы  
* ```onAll```, ```offAll```  — для подписки на все события и сброса всех
подписчиков  
* ```trigger``` генерирует заданное событие с заданными
аргументами. Это позволяет передавать его в качестве обработчика события в другие классы

### Класс Component<T>

Абстрактный класс Component<T>, который предоставляет базовый функционал для работы с DOM-элементами в дочерних компонентах.  

```constructor(container: HTMLElement)``` принимает контейнер

Методы

* ```toggleClass```: Переключает класс у указанного элемента.  
* ```setText```: Устанавливает текстовое содержимое элемента.  
* ```setDisabled```: Устанавливает или убирает атрибут disabled для блокировки или разблокировки элемента.  
* ```setHidden```: Скрывает элемент, устанавливая стиль display: none.  
* ```setVisible```: Показывает элемент, удаляя стиль display: none.  
* ```setImage```: Устанавливает изображение для элемента с опциональным альтернативным текстом.  
* ```render```: Возвращает корневой DOM-элемент компонента. Принимает объект data в качестве аргумента, который может содержать данные для инициализации компонента.

### Класс API

Класс Api предоставляет удобные методы для выполнения GET и POST запросов с использованием Fetch API.  

```constructor(baseUrl: string, options: RequestInit = {})``` принимает базовую ссылку и опции

Методы

* ```handleResponse```: Обрабатывает ответ от сервера.  
* ```get```: Выполняет GET-запрос к указанному URI (дополняя его базовым URL).  
* ```post```: Выполняет POST-запрос к указанному URI (дополняя его базовым URL).  

### Класс Model<T>

Общий функционал этого класса позволяет создавать модели с возможностью уведомления других компонентов или сервисов о своих изменениях.

```constructor(data: Partial<T>, protected events: IEvents)``` принимает данные для модели и объект событий 

Методы

* ```emitChanges```:  Уведомляет об изменениях, вызывая метод emit из объекта событий (events).  

## Общие компоненты представления

### Form

Этот класс предназначен для работы с формами в интерфейсе приложения, обрабатывая ввод пользователя, отслеживая изменения и уведомляя другие компоненты о событиях формы.

```constructor(protected container: HTMLFormElement, protected events: IEvents)```: Принимает container (HTML-элемент формы) и объект событий (events).

Методы

* ```onInputChange```: Обработчик изменений в полях формы.  
* ```set valid``` и ```set errors```: Устанавливают состояние валидности формы и отображают ошибки, соответственно.  
* ```render```: Обновляет состояние формы, включая валидность, ошибки и значения полей.  

### Modal 

Этот класс управляет отображением и состоянием модального окна в интерфейсе приложения.

```constructor(container: HTMLElement, protected events: IEvents)``` Принимает container (HTML-элемент модального окна) и объект событий (events).  

Методы  

* ```set content```: Устанавливает контент модального окна, заменяя текущий контент на переданный элемент.
* ```open()``` и ```close()```: Открывают и закрывают модальное окно соответственно.  
* ```render```:  Обновляет состояние модального окна, используя переданные данные.  

## Компоненты представления

### Basket

Этот класс отвечает за отображение и управление состоянием корзины в интерфейсе приложения. При изменении элементов и общей стоимости, класс обновляет соответствующие элементы на странице.  

```constructor(container: HTMLElement, protected events: EventEmitter)```: Принимает container (корневой элемент корзины) и объект событий (events).  

Методы

* ```set items```:  Устанавливает содержимое корзины.  
* ```set total```: Устанавливает общую стоимость корзины, используя переданное значение.  
* ```disableBuyButton```: выключает кнопку в зависимости от стейта

### Success

Этот класс отвечает за отображение сообщения об успешном заказе и предоставляет возможность выполнения дополнительных действий при успешном сценарии, таких как закрытие модального окна или перенаправление на другую страницу.  

```constructor(container: HTMLElement, actions: ISuccessActions)```: принимает container (HTML-элемент для отображения сообщения об успешном заказе) и объект actions с действиями при успешном заказе.  
  
Методы

* ```set total```:  Обновляет содержимое элемента _total текстом, указывая количество синапсов.

### Card 

Этот класс предназначен для отображения информации о продукте в интерфейсе приложения и обеспечивает взаимодействие с другими компонентами через заданные действия.

```constructor(container: HTMLElement, actions?: ICardActions)``` принимает container (HTML-элемент карточки продукта) и объект actions с действиями для карточки.


Методы 

* ```set category``` и ```get category```: Устанавливают и возвращают категорию продукта, также добавляя соответствующий класс стиля.  
* ```set index``` и ```get index```: Устанавливают и возвращают индекс продукта в корзине.  
* ```set id``` и ```get id```: Устанавливают и возвращают уникальный идентификатор продукта.  
* ```set image```: Устанавливает изображение продукта, используя метод setImage.  
* ```set price```: Устанавливают и возвращают цену продукта.  
* ```turnOffButton```: выключает кнопку
* ```set titleButton```: устанавливает текст кнопки покупки

### ContactModal:

Этот класс представляет модальное окно для ввода контактных данных (телефона и электронной почты) при оформлении заказа.  

```constructor(container: HTMLFormElement, events: IEvents)``` принимает container (HTML-элемент карточки продукта) и объект событий (events)

Методы

* ```set phone``` для установки поля телефона
* ```set email``` для установки поля почты

### OrderModal:

Этот класс представляет модальное окно для ввода данных о заказе, таких как адрес доставки и способ оплаты.

```constructor(container: HTMLFormElement, events: IEvents, actions?: ICardActions)```: принимает container (HTML-элемент карточки продукта) и объект actions с действиями для карточки и объект событий (events)

Методы

* ```setAddress``` для установки значения поля адреса доставки.    
* ```toggleClassButton``` переключение класса для выбора способа оплаты

### Page

Этот класс управляет отображением основной страницы интернет-магазина, обновляет содержимое счетчика корзины, каталога продуктов и блокирует страницу при необходимости.  

```constructor(container: HTMLElement, protected events: IEvents)```: Принимает container (HTML-элемент страницы) и объект событий (events).  

* ```set counter```, ```set catalog``` и ```set locked```:  устанавливают соответственно значения счетчика корзины, содержимого каталога и блокировки страницы.

## Используемые события 

```items:changed```: Срабатывает, когда изменяются элементы каталога.  
```contacts:submit```: Вызывается при отправке данных контактной формы.  
```formErrors:change```: Событие, сигнализирующее об изменении состояния валидации формы.  
```order.{field}:change```: Изменение одного из полей для доставки.  
```contacts.{field}:change```: Изменение одного из полей для контактов.  
```payment:change```: Срабатывает при изменении выбранного метода оплаты.  
```order:open```: Срабатывает при открытии формы заказа.  
```order:submit```: Срабатывает при отправке данных формы заказа.  
```basket:open```: Срабатывает при открытии корзины.  
```card:select```: Срабатывает при выборе карточки товара.  
```product:add```: Срабатывает при добавлении товара в корзину.  
```product:delete```: Срабатывает при удалении товара из корзины.  
```basket:changed```: Срабатывает при изменении содержимого корзины.  
```counter:changed```: Срабатывает при изменении счетчика товаров на корзинке.  
```preview:changed```: Срабатывает при изменении открытого выбранного товара.  
```modal:open```: Срабатывает при открытии модального окна.  
```modal:close```: Срабатывает при закрытии модального окна.  

## Ключевые типы данных 

```EventName```: Тип для представления имени события, может быть строкой или регулярным выражением.  
```Subscriber```: Тип для представления функции-подписчика события.  
```EmitterEvent```: Тип данных, представляющий событие с именем и данными.  
```FormErrors```: Тип для представления ошибок формы, ассоциированных с полями заказа.  
```ApiPostMethods```: Тип для представления методов HTTP-запроса (POST, PUT, DELETE).  
```ApiListResponse```: Тип данных для представления ответа от API, содержащего список элементов указанного типа.  

## Интерфейсы

```IFormState```: Интерфейс для представления состояния формы с флагом валидности и массивом ошибок.  
```IProductItem```: Интерфейс для представления свойств продукта в каталоге.  
```ICard```: Интерфейс для представления свойств карточки продукта, расширяющий интерфейс IProductItem.  
```ICardActions```: Интерфейс для представления действий, связанных с карточкой продукта.  
```IOrderModal```: Интерфейс для представления модальных данных заказа, таких как способ оплаты и адрес доставки.  
```IContactModal```: Интерфейс для представления модальных данных контактов, таких как электронная почта и телефон.  
```IOrder```: Интерфейс для представления заказа, расширяющий интерфейсы IOrderModal и IContactModal.  
```IAppState```: Интерфейс для представления состояния приложения, содержащего каталог, корзину, превью, заказ и модальные данные.  
```IWebLarekAPI```: Интерфейс для представления методов API, таких как получение списка продуктов, получение отдельного продукта и размещение заказа.  
```IOrderResult```: Интерфейс для представления результата заказа, содержащего идентификатор и общую стоимость.  
```IPage```: Интерфейс для представления страницы, содержащей счетчик и каталог элементов.  
```IEvents```: Интерфейс для работы с событиями, предоставляющий методы для подписки и эмитации событий.  
```ISuccess```: Интерфейс для представления успешного действия, содержащего общую стоимость.  
```ISuccessActions```: Интерфейс для представления действий, связанных с успешным сценарием.  
```IBasketView```: Интерфейс для представления представления корзины, содержащего элементы и общую стоимость.  
```IModalData```: Интерфейс для представления данных модального окна, содержащего контент.